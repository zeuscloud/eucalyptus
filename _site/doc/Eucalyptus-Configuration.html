<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>Zeus Cloud Eucalyptus Documentation  : Eucalyptus Configuration</title>
        <meta name="description" content="Eucalyptus Cloud">

        <link href="/css/bootmin.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class=row-fluid>
                <div id=header class=span12>
                    <h4><a class=brand href="/">Zeus Cloud Eucalyptus Documentation </a>
    <small>Eucalyptus Cloud</small>
</h4>


                </div>
            </div>

            <div class=row-fluid>
                
                
                    <div id=navigation class=span2>
                        <ul class="nav nav-list">
    <li><a href="/">Home</a></li>
    
        
        

        
            
                <li class=nav-header>Documentation</li>
            
            <li data-order="1"><a href="/doc/Installation-Centos.html">Centos 6 OS Installation <br />  </a></li>
        
            
            <li data-order="3"><a href="/doc/Eucalyptus-Installation.html">Eucalyptus Installation <br />  </a></li>
        
            
            <li data-order="2"><a href="/doc/Eucalyptus-Configuration.html">Eucalyptus Configuration <br />  </a></li>
        
    
        
        

        
    
        
        

        
    
        
        

        
    
        
        

        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class=divider></li> first to break up the content. -->
</ul>

                    </div>

                    <div id=content class=span10>
                        <div class=page-header>
    <h2>Eucalyptus Configuration
        
    </h2>
</div>

<h3 id="configuring-the-network-in-controller">Configuring the network in Controller</h3>

<h4 id="opening-ports">Opening Ports</h4>

<div class="highlight"><pre><code class="bash">iptables -A INPUT -i eth1 -p tcp --dport 8772 -j ACCEPT
iptables -A INPUT -i eth1 -p tcp --dport 8773 -j ACCEPT
iptables -A INPUT -i eth1 -p tcp --dport 8774 -j ACCEPT
iptables -A INPUT -i eth1 -p tcp --dport 8776 -j ACCEPT
iptables -A INPUT -i eth1 -p tcp --dport 8777 -j ACCEPT
iptables -A INPUT -i eth1 -p tcp --dport 8080 -j ACCEPT
iptables -A INPUT -i eth1 -p udp --dport 8773 -j ACCEPT
iptables -A INPUT -i eth1 -p udp --dport 7500 -j ACCEPT
service iptables save</code></pre></div>

<h4 id="accepting-everything-from-tcp-and-udp">Accepting everything from TCP and UDP</h4>

<div class="highlight"><pre><code class="bash">iptables -A INPUT -p udp --dport 0:1023 -j ACCEPT
iptables -A INPUT -p tcp --dport 0:1023 -j ACCEPT
/sbin/service iptables save</code></pre></div>

<h4 id="opening-ports-required-for-dns-functioning">Opening ports required for DNS functioning</h4>

<h3 id="network-configurations-in-main-node-(-cc-/-clc-/-walrus-)">Network Configurations in Main node ( CC / CLC / Walrus )</h3>

<h5 id="eth0---public-network-interface">Eth0 - Public network Interface</h5>

<table border="1">
    <tr>
        <td>IP</td>
        <td>192.168.41.203</td>
    </tr>
    <tr>
        <td>gw</td>
        <td>192.168.41.1</td>
    </tr>
    <tr>
        <td>dns</td>
        <td>192.168.254.2</td>
    </tr>
    <tr>
        <td>Netmask</td>
        <td>24</td>
    </tr>
</table>

<h5 id="eth1---private-network-interface">Eth1 - Private network Interface</h5>

<table border="1">
    <tr>
        <td>IP</td>
        <td>10.0.0.1</td>
    </tr>
    <tr>
        <td>gw</td>
        <td>10.0.0.1</td>
    </tr>
    <tr>
        <td>dns</td>
        <td>192.168.254.2</td>
    </tr>
    <tr>
        <td>Netmask</td>
        <td>24</td>
    </tr>
</table>

<h3 id="check-network">Check Network</h3>

<h5 id="install-git-and-java">Install git and java</h5>

<div class="highlight"><pre><code class="bash">yum install java-devel git git-core</code></pre></div>

<h5 id="network-check-script">Network Check Script</h5>

<p>Test multicast connectivity between each CLC and Walrus, SC, and VMware broker host.
* Clone the Eucalyptus deveutils repository</p>

<p><code>git clone https://github.com/eucalyptus/deveutils</code></p>

<ul>
<li>Run the network-tomography tool on the Cloud Controller, Cluster Controller, Storage Controller, and any
machines running Walrus or VMware Broker, passing a list of IP addresses for each of these machines.</li>
</ul>

<div class="highlight"><pre><code class="bash"><span class="nb">cd </span>deveutils/network-tomography
./network-tomography 10.0.0.1 10.0.0.2</code></pre></div>

<h3 id="configure-dependencies">Configure Dependencies</h3>

<p>Before you install Eucalyptus, make sure you have the following dependencies installed and configured.</p>

<h4 id="configure-bridges">Configure Bridges</h4>

<p>For Managed (No VLAN), Static, and System modes, you must configure a Linux ethernet bridge on all NC machines.This bridge connects your local ethernet adapter to the cluster network. Under normal operation, NCs will attach virtual machine instances to this bridge when the instances are booted.</p>

<p>To configure a bridge in CentOS 6 or RHEL6, you need to create a file with bridge configuration (for example, ifcfg-brX) and modify the file for the physical interface (for example, ifcfg-ethX).</p>

<ul>
<li>Install the bridge-utils package.</li>
</ul>

<p><code>yum install bridge-utils</code></p>

<ul>
<li><p>Go to the <code>/etc/sysconfig/network-scripts</code> directory:
<code>cd /etc/sysconfig/network-scripts</code></p></li>
<li><p>Open the network script for the device you are adding to the bridge and add your bridge device to it { the file is usually named as ifcfg-eth0 }. The edited file should look similar to the following:</p></li>
</ul>

<div class="highlight"><pre><code class="bash"><span class="nv">DEVICE</span><span class="o">=</span>eth0
<span class="nv">HWADDR</span><span class="o">=</span>00:16:76:D6:C9:45 <span class="c">#change the hardware address </span>
<span class="nv">ONBOOT</span><span class="o">=</span>yes
<span class="nv">BRIDGE</span><span class="o">=</span>br0
<span class="nv">NM_CONTROLLED</span><span class="o">=</span>no</code></pre></div>

<ul>
<li> Create a new network script in the /etc/sysconfig/network-scripts directory called ifcfg-br0 or something similar. The br0 is the name of the bridge, but this can be anything as long as the name of the file is the same as the DEVICE parameter, and the name is specified correctly in the previously created physical interface
configuration (ifcfg-ethX).</li>
</ul>

<div class="highlight"><pre><code class="bash"><span class="nv">DEVICE</span><span class="o">=</span>br0
<span class="nv">TYPE</span><span class="o">=</span>Bridge
<span class="nv">BOOTPROTO</span><span class="o">=</span>static
<span class="nv">IPADDR</span><span class="o">=</span>10.0.0.2
<span class="nv">NETMASK</span><span class="o">=</span>255.255.255.0
<span class="nv">GATEWAY</span><span class="o">=</span>10.0.0.1
<span class="nv">ONBOOT</span><span class="o">=</span>yes</code></pre></div>

<ul>
<li>Stop the NetworkManager</li>
</ul>

<p><code>service NetworkManager stop</code></p>

<ul>
<li>Restart Network</li>
</ul>

<p><code>service network restart</code></p>

<h3 id="disable-the-firewall">Disable the Firewall</h3>

<p>If you have existing firewall rules on your hosts, you should disable the firewall in order to install Eucalyptus. <strong>You
should re-enable it after installation.</strong></p>

<p>Tip: If you do not have a firewall enabled, skip this step.</p>

<p>To disable your firewall:</p>

<ul>
<li>Run the command <code>system-config-firewall-tui</code></li>
<li>Turn off the Enabled check box.</li>
</ul>

<p>Repeat on each host that will run a Eucalyptus component: Cloud Controller, Walrus, Cluster Controller, Storage Controller, and Node Controllers.</p>

<h3 id="configure-selinux">Configure SELinux</h3>

<p>Security-enabled Linux (SELinux) is security feature for Linux that allows you to set access control through policies.
Eucalyptus is not compatible with SELinux. </p>

<p>To configure SELinux to allow Eucalyptus access:</p>

<ul>
<li>Open <code>/etc/selinux/config</code> and edit the line <code>SELINUX=enforcing</code> to <code>SELINUX=permissive</code>.</li>
<li>Save the file.</li>
<li>Run the following command:</li>
</ul>

<p><code>setenforce 0</code></p>

<h3 id="configure-ntp">Configure NTP</h3>

<p>Eucalyptus requires that each machine have the Network Time Protocol (NTP) daemon started and configured to run
automatically on reboot.
To use NTP:</p>

<ul>
<li>Install NTP on the machines that will host Eucalyptus components.</li>
</ul>

<p><code>yum install ntp</code></p>

<ul>
<li>Open the <code>/etc/ntp.conf</code> file and add NTP servers, as in the following example.</li>
</ul>

<div class="highlight"><pre><code class="bash">server 0.pool.ntp.org
server 1.pool.ntp.org
server 2.pool.ntp.org</code></pre></div>

<ul>
<li>Save and close the file.</li>
<li>Configure NTP to run at reboot.
<code>chkconfig ntpd on</code></li>
<li>Start NTP.
<code>service ntpd start</code></li>
<li>Synchronize your server.
<code>ntpdate -u &lt;your_ntp_server&gt;</code></li>
<li>Synchronize your system clock, so that when your system is rebooted, it does not get out of sync.
<code>hwclock --systohc</code></li>
<li>Repeat on each host that will run a Eucalyptus component.</li>
</ul>

<p>In case if NTP port is blocked you may run your own ntp server and modify your clients to update from that server.
To set up your own NTP server, follow these steps :</p>

<hr>

<h4 id="do-the-following-in-main-node-(-only-if-ntp-is-blocked-)">Do the following in Main Node ( Only if NTP is blocked )</h4>

<ul>
<li><p>back up your ntp configuration file
<code>mv /etc/ntp.conf /etc/ntp.conf.bkp</code></p></li>
<li><p>create a new <code>/etc/ntp.conf</code> file with the following code in it</p></li>
</ul>

<div class="highlight"><pre><code class="bash"><span class="c"># Use the local clock</span>
server 127.127.1.0 prefer
fudge  127.127.1.0 stratum 10
driftfile /var/lib/ntp/drift
broadcastdelay 0.008

<span class="c"># Give localhost full access rights</span>
restrict 127.0.0.1

<span class="c"># Give machines on our network access to query us</span>
restrict 10.0.0.1 mask 255.255.255.0 nomodify notrap</code></pre></div>

<ul>
<li>save and close the ntp configuration file</li>
<li><p>restart the ntp daemon
<code>service ntpd restart</code></p></li>
<li><p>configure ntpd to start at reboot
<code>chkconfig ntpd on</code></p>

<hr>

<h4 id="do-the-following-in-node-controllers-(-only-if-ntp-is-blocked-)">Do the following in Node Controllers ( Only if NTP is blocked )</h4>

<p>Follow these steps to instruct the clients to use the local NTP server :</p></li>
<li><p>backup the existing ntp configuration file
<code>mv /etc/ntp.conf /etc/ntp.conf.bkp</code>Follow</p></li>
<li><p>create a new ntp configuration file with the following lines in it</p></li>
</ul>

<div class="highlight"><pre><code class="bash"><span class="c"># Point to our network&#39;s master time server</span>
server 10.0.0.1

restrict default ignore
restrict 127.0.0.1
restrict 10.0.0.1 mask 255.255.255.255 nomodify notrap noquery

driftfile /var/lib/ntp/drift</code></pre></div>

<ul>
<li>save and close the ntp configuration file</li>
<li>stop running the NTP daemon
<code>service ntpd stop</code></li>
<li>force an update using the local ntp server
<code>ntpdate -u 10.0.0.1</code></li>
<li>start the ntp daemon
<code>service ntpd start</code></li>
<li>configure ntpd to start on reboot
<code>chkconfig ntpd on</code></li>
<li>Synchronize your system clock, so that when your system is rebooted, it does not get out of sync.
<code>hwclock --systohc</code></li>
</ul>

<h3 id="enable-ip-forwarding">Enable IP Forwarding</h3>

<p>Edit the <code>sysctl.conf</code> on each machine you plan to install the Cluster Controller (CC) component on. IP forwarding is required for the CC to work.
To manually enable IP forwarding:</p>

<ul>
<li>Enter the following command on the CC:<br>
<code>net.ipv4.ip_forward = 1</code><br></li>
</ul>

<p>This ensures that if any dependency (or other unrelated software component) on the system reloads <code>sysctl.conf</code> that it won&#39;t turn off IP forwarding.</p>


                    </div>
                
            </div>
<!--
            <div class=row-fluid>
                <div id=footer class=span12>
                    Documentation for <a href="https://github.com/sudev/MinixMajor">Zeus Cloud Eucalyptus Documentation </a>

                </div>
            </div>
 -->       </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
    </body>
</html>
